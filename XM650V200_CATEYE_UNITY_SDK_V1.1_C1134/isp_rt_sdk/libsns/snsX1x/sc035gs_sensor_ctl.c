#include "isp_type.h"
#include "isp_print.h"
#include "isp_i2c.h"
#include "isp_sns_ctrl.h"
#include "XAx_cmos.h"


//Mclk: 24M
//Pclk: 72M
//Active:640*480
//Total:1136*2112*30fps
//DVP
static const ISP_U16 gau16SnsInit_sc035GS_dvp[][2] = {
	{0x0100,0x00},
	{0x36e9,0x80},
	{0x36f9,0x80},
	{0x300f,0x0f},
	{0x3018,0x1f},
	{0x3019,0xff},
	{0x301c,0xb4},
	{0x301f,0x8c},
	{0x3028,0x82},
	{0x3031,0x0a},
	{0x3037,0x20},
	{0x320c,0x04},
	{0x320d,0x70},
	{0x320e,0x02},
	{0x320f,0x10},
	{0x3217,0x00},
	{0x3218,0x00},
	{0x3220,0x10},
	{0x3223,0x48},
	{0x3226,0x74},
	{0x3227,0x07},
	{0x323b,0x00},
	{0x3250,0xf0},
	{0x3251,0x02},
	{0x3252,0x02},
	{0x3253,0x08},
	{0x3254,0x02},
	{0x3255,0x07},
	{0x3304,0x48},
	{0x3305,0x00},
	{0x3306,0x98},
	{0x3309,0x50},
	{0x330a,0x01},
	{0x330b,0x18},
	{0x330c,0x18},
	{0x330f,0x40},
	{0x3310,0x10},
	//{0x3314,0x6b},
	{0x3315,0x30},
	{0x3316,0x68},
	//{0x3317,0x14},
	{0x3329,0x5c},
	{0x332d,0x5c},
	{0x332f,0x60},
	{0x3335,0x64},
	{0x3344,0x64},
	{0x335b,0x80},
	{0x335f,0x80},
	{0x3366,0x06},
	{0x3385,0x31},
	{0x3387,0x39},
	{0x3389,0x01},
	{0x33b1,0x03},
	{0x33b2,0x06},
	{0x33bd,0xe0},
	{0x33bf,0x10},
	{0x3621,0xa4},
	{0x3622,0x05},
	{0x3624,0x47},
	//{0x3630,0x4a},
	//{0x3631,0x58},
	{0x3633,0x52},
	{0x3635,0x03},
	{0x3636,0x25},
	{0x3637,0x8a},
	{0x3638,0x0f},
	{0x3639,0x08},
	{0x363a,0x00},
	{0x363b,0x48},
	{0x363c,0x86},
	{0x363e,0xf8},
	{0x3640,0x00},
	{0x3641,0x01},
	{0x36ea,0x36},
	{0x36eb,0x0e},
	{0x36ec,0x1e},
	{0x36ed,0x00},
	{0x36fa,0x36},
	{0x36fb,0x10},
	{0x36fc,0x00},
	{0x36fd,0x00},
	{0x3908,0x91},
	{0x391b,0x81},
	{0x3d08,0x01},
	//{0x3e01,0x18},
	//{0x3e02,0xf0},
	{0x3e03,0x2b},
	//{0x3e06,0x0c},
	{0x3f04,0x03},
	{0x3f05,0x80},
	{0x4500,0x59},
	{0x4501,0xc4},
	{0x4800,0x64},
	{0x4809,0x01},
	{0x4810,0x00},
	{0x4811,0x01},
	{0x4837,0x38},
	{0x5011,0x00},
	{0x5988,0x02},
	{0x598e,0x04},
	{0x598f,0x30},
	//30fps
	{0x320e,0x08},
	{0x320f,0x40},
	{0x3252,0x08},	//vts-8
	{0x3253,0x38},
	//fsync
	{0x3032,0xc0},
	{0x3217,0x08},	//vts-5
	{0x3218,0x3b},
	{0x36e9,0x03},
	{0x36f9,0x03},
	//Init Exposure
	{0x3e00,0x00},
	{0x3e01,0x83},
	{0x3e02,0x80},
	{0x3e06,0x0c},
	{0x3e07,0x80},
	{0x3e08,0x03},
	{0x3e09,0x10},
	{0x3314,0x6b},
	{0x3317,0x14},
	{0x3630,0x4a},
	{0x3631,0x58},

	{0x0100,0x01},
	//delay 10ms
	{0x4418,0x0a},
	{0x363d,0x10},
	{0x4419,0x80},

};

static const ISP_U16 gau16SnsInit_sc035GS_mipi[][2] = {
	{0x0100,0x00},
	{0x36e9,0x80},
	{0x36f9,0x80},
	{0x3000,0x00},
	{0x3001,0x00},
	{0x300f,0x0f},
	{0x3018,0x13},
	{0x3019,0xfe},
	{0x301c,0x78},
	{0x301f,0xb5},
	{0x3031,0x0a},
	{0x3037,0x20},
	{0x303f,0x01},
	{0x320c,0x04},
	{0x320d,0x70},
	{0x320e,0x02},
	{0x320f,0x10},
	{0x3217,0x00},
	{0x3218,0x00},
	{0x3220,0x10},
	{0x3223,0x48},
	{0x3226,0x74},
	{0x3227,0x07},
	{0x323b,0x00},
	{0x3250,0xf0},
	{0x3251,0x02},
	{0x3252,0x02},
	{0x3253,0x08},
	{0x3254,0x02},
	{0x3255,0x07},
	{0x3304,0x48},
	{0x3305,0x00},
	{0x3306,0x98},
	{0x3309,0x50},
	{0x330a,0x01},
	{0x330b,0x18},
	{0x330c,0x18},
	{0x330f,0x40},
	{0x3310,0x10},
	//{0x3314,0x6b},
	{0x3315,0x30},
	{0x3316,0x68},
	//{0x3317,0x14},
	{0x3329,0x5c},
	{0x332d,0x5c},
	{0x332f,0x60},
	{0x3335,0x64},
	{0x3344,0x64},
	{0x335b,0x80},
	{0x335f,0x80},
	{0x3366,0x06},
	{0x3385,0x31},
	{0x3387,0x39},
	{0x3389,0x01},
	{0x33b1,0x03},
	{0x33b2,0x06},
	{0x33bd,0xe0},
	{0x33bf,0x10},
	{0x3621,0xa4},
	{0x3622,0x05},
	{0x3624,0x47},
	//{0x3630,0x4a},
	//{0x3631,0x58},
	{0x3633,0x52},
	{0x3635,0x03},
	{0x3636,0x25},
	{0x3637,0x8a},
	{0x3638,0x0f},
	{0x3639,0x08},
	{0x363a,0x00},
	{0x363b,0x48},
	{0x363c,0x86},
	{0x363e,0xf8},
	{0x3640,0x00},
	{0x3641,0x01},
	{0x36ea,0x36},
	{0x36eb,0x0e},
	{0x36ec,0x0e},
	{0x36ed,0x00},
	{0x36fa,0x36},
	{0x36fb,0x10},
	{0x36fc,0x00},
	{0x36fd,0x00},
	{0x3908,0x91},
	{0x391b,0x81},
	{0x3d08,0x01},
	//{0x3e01,0x18},
	//{0x3e02,0xf0},
	{0x3e03,0x2b},
	//{0x3e06,0x0c},
	{0x3f04,0x03},
	{0x3f05,0x80},
	{0x4500,0x59},
	{0x4501,0xc4},
	{0x4603,0x00},
	{0x4800,0x64},
	{0x4809,0x01},
	{0x4810,0x00},
	{0x4811,0x01},
	{0x4837,0x1c},
	{0x5011,0x00},
	{0x5988,0x02},
	{0x598e,0x04},
	{0x598f,0x40},
	
	{0x320e,0x08},
	{0x320f,0x3e},
#if 1
	//slave
	{0x3222,0x02},
	{0x3231,0x2a},
	{0x3223,0x4c},
	{0x3226,0x06},
	{0x3227,0x06},
	{0x3228,0x08},
	{0x3229,0x38},	// vts-6
	{0x322b,0x0b},
	{0x3225,0x04},
#endif	
	{0x36e9,0x03},
	{0x36f9,0x03},
	//Init Exposure
	{0x3e00,0x00},
	{0x3e01,0x83},
	{0x3e02,0x80},
	{0x3e06,0x0c},
	{0x3e07,0x80},
	{0x3e08,0x03},
	{0x3e09,0x10},
	{0x3314,0x6b},
	{0x3317,0x14},
	{0x3630,0x4a},
	{0x3631,0x58},

	{0x0100,0x01},
	//delay 10ms
	{0x4418,0x0a},
	{0x363d,0x10},
	{0x4419,0x80},
};

void sensor_init_sc035GS(ISP_DEV IspDev)
{
	ISP_U16 u16Num,u16i;
	if(SENSCONT_DVP == gstSnsAttr[IspDev].enCmosIF)
	{
		u16Num = sizeof(gau16SnsInit_sc035GS_dvp)/sizeof(gau16SnsInit_sc035GS_dvp[0]);
		u16Num = u16Num-3;
		for(u16i=0; u16i < u16Num; u16i++)
		{
			sensor_write_register(IspDev,(ISP_U32)gau16SnsInit_sc035GS_dvp[u16i][0], (ISP_U32)gau16SnsInit_sc035GS_dvp[u16i][1]);
		}
		XM_MPI_ISP_USleep(10000);
		u16Num = u16Num+3;
		for(;u16i < u16Num; u16i++)
		{
			sensor_write_register(IspDev,(ISP_U32)gau16SnsInit_sc035GS_dvp[u16i][0], (ISP_U32)gau16SnsInit_sc035GS_dvp[u16i][1]);
		}
		//DEBUG("------------- sc035GS init ok! DVP(@20220606) ----------------\n");
	}
	else
	{
		u16Num = sizeof(gau16SnsInit_sc035GS_mipi)/sizeof(gau16SnsInit_sc035GS_mipi[0]);
		u16Num = u16Num-3;
		for(u16i=0; u16i < u16Num; u16i++)
		{
			sensor_write_register(IspDev,(ISP_U32)gau16SnsInit_sc035GS_mipi[u16i][0], (ISP_U32)gau16SnsInit_sc035GS_mipi[u16i][1]);
		}
		XM_MPI_ISP_USleep(10000);
		u16Num = u16Num+3;
		for(;u16i < u16Num; u16i++)
		{
			sensor_write_register(IspDev,(ISP_U32)gau16SnsInit_sc035GS_mipi[u16i][0], (ISP_U32)gau16SnsInit_sc035GS_mipi[u16i][1]);
		}
		//DEBUG("------------- sc035GS init ok! MIPI(@20220606) ----------------\n");
	}
}



